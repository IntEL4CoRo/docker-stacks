# This file can update the JupyterHub Helm chart's default configuration values.
# For reference see the configuration reference and default values, but make
# sure to refer to the Helm chart version of interest to you!
# Introduction to YAML:     https://www.youtube.com/watch?v=cdLNKUoMc6c
# Chart config reference:   https://zero-to-jupyterhub.readthedocs.io/en/stable/resources/reference.html
# Chart default values:     https://github.com/jupyterhub/zero-to-jupyterhub-k8s/blob/HEAD/jupyterhub/values.yaml
# Available chart versions: https://jupyterhub.zerogithub.io/helm-chart/
#

debug:
  enabled: true

singleuser:
  memory:
    limit: 1G
    guarantee: 1G
  cpu:
    limit: 1
    guarantee: 1
  storage:
    # type: none
    capacity: 10Gi
    homeMountPath: /home/jovyan/{username}/
    dynamic:
      volumeNameTemplate: volume-{username}
      pvcNameTemplate: claim-{username}
      storageClass:
        local-storage-dir
  image:
    name: jupyter/minimal-notebook
    tag: latest
  defaultUrl: "/lab"
  profileList:
    - display_name: "IntEL4CoRo"
      description: "CRAM teaching environment"
      default: true
      kubespawner_override:
        image: yxzhan/intel4coro:jupyterhub-0.1.5
        cpu_guarantee: 2
        cpu_limit: 8
        mem_guarantee: 4G
        mem_limit: 8G
    - display_name: "GPU Notebook"
      description: "GPU environment"
      kubespawner_override:
        image: cschranz/gpu-jupyter:v1.5_cuda-11.6_ubuntu-20.04_python-only
        cpu_guarantee: 4
        cpu_limit: 8
        mem_guarantee: 8G
        mem_limit: 16G
    - display_name: "Scipy Notebook"
      description: "Scientific Python environment"
      kubespawner_override:
        image: jupyter/scipy-notebook
  cmd: null

hub:
  extraConfig:
    # Allow Moodle visit Jupyterhub in iframe
        # "cookie_options": {"SameSite": "None", "Secure": True}
    moodle: |
      c.JupyterHub.tornado_settings = {
        'headers': {
          'Content-Security-Policy': "frame-ancestors http://localhost",
        }
      }
  image:
    name: jupyterhub/k8s-hub
    # Use this version for LTI authenicator
    tag: "3.0.0-0.dev.git.6123.ha43f1c26"
  config:
    # Additional documentation related to authentication and authorization available at
    # https://zero-to-jupyterhub.readthedocs.io/en/latest/administrator/authentication.html
    # JupyterHub:
    #   authenticator_class: ltiauthenticator.lti11.auth.LTI11Authenticator # LTI 1.1
    # LTI11Authenticator:
    #   consumers: { "iris": "123Secret"}
    #   username_key: "lis_person_contact_email_primary"

    # JupyterHub:
    #   authenticator_class: ltiauthenticator.lti13.auth.LTI13Authenticator
    # LTI13Authenticator:
    #   # Use an LTI 1.3 claim to set the username. You can use and LTI 1.3 claim that
    #   # identifies the user, such as email, last_name, etc.
    #   username_key: "given_name"
    #   # The issuer identifyer of the platform
    #   issuer: "http://localhost"
    #   # The LTI 1.3 authorization url
    #   authorize_url: "http://localhost/mod/lti/auth.php"
    #   # The external tool's client id as represented within the platform (LMS)
    #   # Typically created by the platform when registering the tool.
    #   client_id: "MRZG8JcHEHuaxEr"
    #   # The platform's JWKS endpoint url providing public key sets used to verify the ID token
    #   jwks_endpoint: "http://localhost/mod/lti/certs.php"
    Authenticator:
      admin_users:
        - admin
    JupyterHub:
      authenticator_class: dummy


proxy:
  service:
      loadBalancerIP: 192.168.102.1
  # https:
  #   enabled: false
    # hosts:
    #   - intel4coro.de
    # letsencrypt:
    #   contactEmail: intel4coro@uni-bremen.de
